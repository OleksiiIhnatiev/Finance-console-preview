import{a as w,b as P,d as W,f as k,k as B,l as A,m as I,q as z}from"./chunk-TBWVQWVQ.js";import{a as O}from"./chunk-3CVUW2BN.js";import"./chunk-4GITJ2X4.js";import{j as D,m as T,n as F}from"./chunk-LCBKTPO3.js";import{$a as a,Ea as S,Ja as y,Qa as m,Sa as t,Ta as n,Za as o,a as f,ab as C,b as h,cb as M,db as p,eb as c,fb as g,hb as v,ia as s,ib as E,ua as l,za as b}from"./chunk-DYTTO7CO.js";function L(_,i){if(_&1&&(t(0,"tr")(1,"td"),a(2),n(),t(3,"td"),a(4),n(),t(5,"td"),a(6),v(7,"currency"),n(),t(8,"td"),a(9),n()()),_&2){let r=i.$implicit;l(2),C(r.issuance_date),l(2),C(r.actual_return_date||"\u041D\u0435 \u043F\u043E\u0432\u0435\u0440\u043D\u0443\u0442\u043E"),l(2),C(E(7,4,r.body)),l(3),C(r.status)}}var N=class _{constructor(i){this.creditsService=i}credits=s([]);allFilteredCredits=s([]);pagedCredits=s([]);currentPage=s(1);pageSize=s(10);totalPages=s(1);filters={issuance_date:{start:"",end:""},actual_return_date:{start:"",end:""},overdue:!1};ngOnInit(){this.loadCredits()}loadCredits(){this.creditsService.getCredits().subscribe(i=>{this.credits.set(i),this.applyFilters()})}applyFilters(){let i=this.credits();this.filters.issuance_date.start&&(i=i.filter(r=>new Date(r.issuance_date)>=new Date(this.filters.issuance_date.start))),this.filters.issuance_date.end&&(i=i.filter(r=>new Date(r.issuance_date)<=new Date(this.filters.issuance_date.end))),i=i.map(r=>h(f({},r),{status:this.calculateStatus(r)})),this.filters.overdue&&(i=i.filter(r=>r.status==="Overdue")),this.allFilteredCredits.set(i),this.totalPages.set(Math.max(1,Math.ceil(i.length/this.pageSize()))),this.changePage(1)}changePage(i){this.currentPage.set(i);let r=(i-1)*this.pageSize(),e=r+this.pageSize();this.pagedCredits.set(this.allFilteredCredits().slice(r,e))}calculateStatus(i){if(!i.actual_return_date)return"Unreturned";let r=new Date(i.actual_return_date),e=new Date(i.return_date);return r>e?"Overdue":"Returned"}resetFilters(){this.filters={issuance_date:{start:"",end:""},actual_return_date:{start:"",end:""},overdue:!1},this.applyFilters()}static \u0275fac=function(r){return new(r||_)(b(O))};static \u0275cmp=S({type:_,selectors:[["app-credits-table"]],decls:63,vars:14,consts:[[1,"container","my-5"],[1,"card","shadow-sm"],[1,"card-body"],[1,"card-title","text-center","mb-4"],[1,"mb-4","p-3","bg-light","rounded"],[1,"mb-3"],[1,"row","g-3"],[1,"col-12","col-md-6","col-lg-3"],["for","issuanceDateStart",1,"form-label"],["id","issuanceDateStart","type","date",1,"form-control",3,"ngModelChange","ngModel"],["for","issuanceDateEnd",1,"form-label"],["id","issuanceDateEnd","type","date",1,"form-control",3,"ngModelChange","ngModel"],["for","returnDateStart",1,"form-label"],["id","returnDateStart","type","date",1,"form-control",3,"ngModelChange","ngModel"],["for","returnDateEnd",1,"form-label"],["id","returnDateEnd","type","date",1,"form-control",3,"ngModelChange","ngModel"],["for","pageSize",1,"form-label"],["id","pageSize",1,"form-control",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-check","mt-3"],["type","checkbox","id","overdue",1,"form-check-input",3,"ngModelChange","ngModel"],["for","overdue",1,"form-check-label"],[1,"text-end","mt-3"],[1,"btn","btn-outline-secondary",3,"click"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","align-middle","text-center"],[1,"table-dark","sticky-top"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","mt-4"],[1,"btn","btn-outline-dark",3,"click","disabled"],[1,"fw-semibold"]],template:function(r,e){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),a(4,"\u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0442\u0430\u0431\u043B\u0438\u0446\u044F \u043A\u0440\u0435\u0434\u0438\u0442\u0456\u0432"),n(),t(5,"div",4)(6,"h5",5),a(7,"\u0424\u0456\u043B\u044C\u0442\u0440\u0438"),n(),t(8,"div",6)(9,"div",7)(10,"label",8),a(11,"\u0414\u0430\u0442\u0430 \u0432\u0438\u0434\u0430\u0447\u0456 (\u0432\u0456\u0434):"),n(),t(12,"input",9),g("ngModelChange",function(u){return c(e.filters.issuance_date.start,u)||(e.filters.issuance_date.start=u),u}),o("ngModelChange",function(){return e.applyFilters()}),n()(),t(13,"div",7)(14,"label",10),a(15,"\u0414\u0430\u0442\u0430 \u0432\u0438\u0434\u0430\u0447\u0456 (\u0434\u043E):"),n(),t(16,"input",11),g("ngModelChange",function(u){return c(e.filters.issuance_date.end,u)||(e.filters.issuance_date.end=u),u}),o("ngModelChange",function(){return e.applyFilters()}),n()(),t(17,"div",7)(18,"label",12),a(19,"\u0414\u0430\u0442\u0430 \u043F\u043E\u0432\u0435\u0440\u043D\u0435\u043D\u043D\u044F (\u0432\u0456\u0434):"),n(),t(20,"input",13),g("ngModelChange",function(u){return c(e.filters.actual_return_date.start,u)||(e.filters.actual_return_date.start=u),u}),o("ngModelChange",function(){return e.applyFilters()}),n()(),t(21,"div",7)(22,"label",14),a(23,"\u0414\u0430\u0442\u0430 \u043F\u043E\u0432\u0435\u0440\u043D\u0435\u043D\u043D\u044F (\u0434\u043E):"),n(),t(24,"input",15),g("ngModelChange",function(u){return c(e.filters.actual_return_date.end,u)||(e.filters.actual_return_date.end=u),u}),o("ngModelChange",function(){return e.applyFilters()}),n()(),t(25,"div",7)(26,"label",16),a(27,"\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u043A\u0440\u0435\u0434\u0438\u0442\u0456\u0432 \u043D\u0430 \u0441\u0442\u043E\u0440\u0456\u043D\u0446\u0456:"),n(),t(28,"select",17),g("ngModelChange",function(u){return c(e.pageSize,u)||(e.pageSize=u),u}),o("ngModelChange",function(){return e.applyFilters()}),t(29,"option",18),a(30,"10"),n(),t(31,"option",18),a(32,"20"),n(),t(33,"option",18),a(34,"50"),n()()()(),t(35,"div",19)(36,"input",20),g("ngModelChange",function(u){return c(e.filters.overdue,u)||(e.filters.overdue=u),u}),o("ngModelChange",function(){return e.applyFilters()}),n(),t(37,"label",21),a(38,"\u0422\u0456\u043B\u044C\u043A\u0438 \u043F\u0440\u043E\u0441\u0442\u0440\u043E\u0447\u0435\u043D\u0456 \u043A\u0440\u0435\u0434\u0438\u0442\u0438"),n()(),t(39,"div",22)(40,"button",23),o("click",function(){return e.resetFilters()}),a(41," \u0421\u043A\u0438\u043D\u0443\u0442\u0438 \u0444\u0456\u043B\u044C\u0442\u0440\u0438 "),n()()(),t(42,"div",24)(43,"table",25)(44,"thead",26)(45,"tr")(46,"th"),a(47,"\u0414\u0430\u0442\u0430 \u0432\u0438\u0434\u0430\u0447\u0456"),n(),t(48,"th"),a(49,"\u0414\u0430\u0442\u0430 \u043F\u043E\u0432\u0435\u0440\u043D\u0435\u043D\u043D\u044F"),n(),t(50,"th"),a(51,"\u0421\u0443\u043C\u0430"),n(),t(52,"th"),a(53,"\u0421\u0442\u0430\u0442\u0443\u0441"),n()()(),t(54,"tbody"),y(55,L,10,6,"tr",27),n()()(),t(56,"div",28)(57,"button",29),o("click",function(){return e.changePage(e.currentPage()-1)}),a(58," \u2190 \u041D\u0430\u0437\u0430\u0434 "),n(),t(59,"span",30),a(60),n(),t(61,"button",29),o("click",function(){return e.changePage(e.currentPage()+1)}),a(62," \u0412\u043F\u0435\u0440\u0435\u0434 \u2192 "),n()()()()()),r&2&&(l(12),p("ngModel",e.filters.issuance_date.start),l(4),p("ngModel",e.filters.issuance_date.end),l(4),p("ngModel",e.filters.actual_return_date.start),l(4),p("ngModel",e.filters.actual_return_date.end),l(4),p("ngModel",e.pageSize),l(),m("value",10),l(2),m("value",20),l(2),m("value",50),l(3),p("ngModel",e.filters.overdue),l(19),m("ngForOf",e.pagedCredits()),l(2),m("disabled",e.currentPage()===1),l(3),M(" \u0421\u0442\u043E\u0440\u0456\u043D\u043A\u0430 ",e.currentPage()," \u0437 ",e.totalPages()," "),l(),m("disabled",e.currentPage()===e.totalPages()))},dependencies:[z,A,I,P,w,B,W,k,T,F,D],encapsulation:2})};export{N as CreditsTableComponent};
